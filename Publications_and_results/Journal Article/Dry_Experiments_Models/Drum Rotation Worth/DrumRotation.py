import matplotlib.pyplot as plt
import numpy as np
import pandas as pd
import statistics as st
import serpentTools

## A Shim Plotting

exp_deg = np.array([-21.28571429,0.285714286 ,15 ,19.42857143 ,23.28571429 ,26.28571429
            ,31.85714286 ,37.28571429 ,40.14285714 ,43.85714286 ,47.42857143
            ,50.42857143 ,53.85714286 ,56.14285714 ,72.28571429 ,76.14285714 
            ,81.42857143 ,88.14285714 ,98.42857143 ,105])
exp_pcm = np.array([-52.14173228, -19.4015748 ,62.4488189,138.8425197,204.3228346,
           275.2598425,406.2204724,602.6614173 ,722.7086614,870.0393701,
           995.5433071,1142.874016,1312.031496,1426.622047,1977.748031,
           2108.708661, 2250.582677,2408.826772, 2528.874016,2561.614173])
exp_unc = exp_pcm*0.1*3

mod_deg = np.array([0 ,10 ,20 ,30 ,40,50,60,70,80,90,100,105])
mod_pcm = np.array([70.17506882, 213.0092137,478.2808532,885.7429685,
                    1415.398245,1987.284513,2506.67259,2915.660739,
                    3196.270668,3354.202449,3381.769717,3382.574514])
mod_unc = np.array([5.186634692,10.2562811 ,15.22435093,20.13476954 ,
                    24.94808675,29.68287404 ,34.31698299,38.85645094 ,
                    43.41522591,48.00478225,51.59249715,54.79355949])*3
plt.errorbar(exp_deg, exp_pcm, exp_unc,marker = "o", linestyle = "-.", label = "Experimental")
plt.errorbar(mod_deg, mod_pcm, mod_unc, marker = "", linestyle = "--", label = "Model", barsabove=True, alpha = 1)
plt.xlabel("Degrees Inserted ")
plt.ylabel("Reactivity [pcm]")
plt.title("Drum No.5 A Shim Integral Worth")
plt.grid()
plt.legend()
plt.show()

## AB Shim Plotting

exp_deg = np.array([7.096774194,13.35621139,21.92175704,23.15717227,
                    26.61633493,30.40494166,41.60603981,43.50034317,
                    47.37131091,55.52505148,65.5730954,67.46739876,
                    69.85586822,74.05628003,79.24502402,84.68085106,
                    96.54083734])
exp_pcm = np.array([306.1763158,371.8289474,529.3952632,552.3736842,
                    657.4178947,782.1578947,1231.878421,1330.357368,
                    1524.032632,1875.274211,2311.864211,2380.799474,
                    2462.865263,2567.909474,2672.953684,2748.454211,
                    2856.781053])
exp_unc = exp_pcm*0.1*3

mod_deg = np.array([0 ,10 ,20 ,30 ,40,50,60,70,80,90,100,105])
mod_pcm = np.array([135.7830429,377.0079394,748.5517061,1243.192243,
                    1805.783878,2349.341059,2805.38688,3149.956954,
                    3383.871432,3506.293557,3525.834734,3528.332012])
mod_unc = np.array([5.027328916,10.03840847,14.91397612,19.69413564,
                    24.47732026,29.26204568,33.89991432,38.42132961,
                    42.94232377,47.47313309,51.0995009,54.34942429])*3
plt.errorbar(exp_deg, exp_pcm, exp_unc,marker = "o", linestyle = "-.", label = "Experimental")
plt.errorbar(mod_deg, mod_pcm, mod_unc, marker = "", linestyle = "--", label = "Model", barsabove=True, alpha = 1)
plt.xlabel("Degrees Inserted ")
plt.ylabel("Reactivity [pcm]")
plt.title("Drum No.5 AB Shim Integral Worth")
plt.grid()
plt.legend()
plt.show()